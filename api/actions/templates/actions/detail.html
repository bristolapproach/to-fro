{% extends 'layouts/application.html' %}

{% load headings %}
{% load markdown %}
{% load svg %}

{% block 'title' %}
  <div class="action-header">
    <p class="action-header__id text-muted">Action <span aria-hidden="true">#</span>{{action.id}}</p>
    <h1 class="m-0">
      <span>{{action.help_type|title}}</span>
      Â­-
      <span>{{action.ward|title}}
    </h1>
    <p class="text-center text-muted ">{{action.requested_datetime|date:"D d M H:i"}}</p>
  </div>
{% endblock%}

{% block 'content' %}

{% if action.assigned_volunteer == volunteer and action.can_reveal_private_information %}
  <h2 class="maf-2">Resident details</h2>
  {% include './_resident_detail.html' with resident=action.resident %}
{% endif %}

<h2 class="maf-2">Action details</h2>
<div class="card p-3">
  {% if action.assigned_volunteer == volunteer and action.can_reveal_private_information %}
    {% if action.private_description %}
    <div class="border-bottom mb-3 pb-3 space-3">
      {{action.private_description|markdown|heading_level:3}}
    </div>
    {% endif %}
  {% endif %}
  {% if action.public_description %}
    <div>
      {{action.public_description|markdown|heading_level:3}}
    </div>
  {% endif %}
  <div class="mbf-3">
    {% if not action.is_assigned %}
      {% include './_action_footer_unassigned.html' with action=action volunteer=volunteer%}
    {%else %}
      {% if action.assigned_volunteer != volunteer %}
        <p class="text-center">Someone's on it, but thanks for thinking of it!</p>
      {% else %}
        {% if action.has_interest %}
          <p class="text-center">Thanks for volunteering! We'll be back in touch soon!</p>
        {% elif action.can_give_feedback %}
          {% include './_action_footer_assigned_to_user.html'%}
        {% else %}
          <p class="alert alert-success mx-n3 mb-n3 text-center border-0 rounded-0">Thanks for helping!</p>
        {% endif %}
      {% endif%}
    {% endif %}
  </div>
</div>
{% include './_problem_help.html' with action=action volunteer=volunteer%}
{% endblock %}
