{% extends 'layouts/application.html' %}

{% load humanize %}
{% load actions %}

{% block extra_head %}
<!-- include bootstrap -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
{% endblock %}

{% block 'content' %}
<nav aria-label="Action types" class="overflow-auto py-1">
  <ul class="d-flex space-x-3 list-unstyled">
    <li class="ml-auto">
    <a href="{% url 'actions:available' %}" class="btn {% if current_list_type == 'available' %} btn-dark{%endif%}"
      {% if current_list_type == 'available' %} aria-current {%endif%}>
      Offer help
    </a>
    </li>
    <li>
    <a href="{% url 'home' %}" class="btn {% if current_list_type == 'mine' %} btn-dark{%endif%}"
      {% if current_list_type == 'mine' %} aria-current {%endif%}>
      Upcoming
    </a>
    </li>
    <li>
    <a href="{% url 'actions:ongoing' %}" class="btn {% if current_list_type == 'ongoing' %} btn-dark{%endif%}"
      {% if current_list_type == 'ongoing' %} aria-current {%endif%}>
      Ongoing
    </a>
    </li>
    <li class="mr-auto">
    <a href="{% url 'actions:completed' %}" class="btn {% if current_list_type == 'completed' %} btn-dark {%endif%}"
      {% if current_list_type == 'completed' %} aria-current {%endif%}>
      Past
    </a>
    </li>
  </ul>
</nav>
{% if actions %}
  {% for action in actions %}
  {% ifchanged action.action_status %}
    {% if action|is_awaiting_confirmation_for:user.volunteer%}
      </ul>
      <h2 class="maf-2 h6 text-center text-muted font-weight-bold">Awaiting approval</h2>
    {% else %}
      <h2 class="sr-only">Actions</h2>
    {% endif %}

    <ul class="list-group bg-white list-unstyled action-list maf-5">
  {% endifchanged %}
  {% include './_action_list_item.html' with action=action volunteer=volunteer %}
  {% endfor %}
</ul>
{% if page_obj.has_other_pages %}
{% include 'layouts/_page_links.html' with page=page_obj %}
{% endif %}
{% if current_list_type == 'available' %}
  <p class="text-muted small">
    If you keep seeing actions you can't volunteer for (either because of the task itself or its location),
    please <a href="mailto:{{settings.COORDINATOR_EMAIL}}">contact a co-ordinator at {{settings.COORDINATOR_EMAIL}} to update your preferences</a>
  </p>
{% endif %}
{% else %}
{% if current_list_type == 'available' %}
<p class="text-center">Sorry, there's nothing available at the moment.</p>
{% else %}
<p class="text-center">Looks like you haven't undertaken any action yet.</p>
<a class="btn btn-primary d-table mx-auto" href="{% url "actions:available" %}">See how you could help!</a>
{% endif %}
{% endif %}
</div>
{% endblock %}
